---
title: 故障排除
layout: /src/layouts/autonum.astro
lastUpdated: 2025-05-18
---

:::tip[提示]
在本页面按`Ctrl`+`F`搜索，或查看右侧边栏查找问题
:::

# 必读事项
## Python虚拟环境

环境变量`$ILLOGICAL_IMPULSE_VIRTUAL_ENV`必须正确设置，否则Quickshell配置的某些功能将无法正常工作。在默认配置文件`~/.config/hypr/hyprland/env.conf`（由`~/.config/hypr/hyprland.conf`调用）中已包含此环境变量。

若该变量缺失，请在Hyprland配置中添加以下内容并重启
```ini
env = ILLOGICAL_IMPULSE_VIRTUAL_ENV, $XDG_STATE_HOME/quickshell/.venv
```

可运行`./diagnose`重新验证变量值

### 预期示例
```
[===diagnose===] declare -p ILLOGICAL_IMPULSE_VIRTUAL_ENV
declare -x ILLOGICAL_IMPULSE_VIRTUAL_ENV="/home/myself/.local/state/quickshell/.venv"
[---SUCCESS---]
```
其中 `myself` 代表实际用户名。

### 异常示例 1
```
[===诊断===] declare -p ILLOGICAL_IMPULSE_VIRTUAL_ENV
./diagnose: 第 30 行: declare: ILLOGICAL_IMPULSE_VIRTUAL_ENV: 未找到
[---退出 1---]
```
针对上述情况：
- 极可能仍在使用旧版 `~/.config/hypr/hyprland.conf`，且忘记将其内容替换为 `~/.config/hypr/hyprland.conf.new`。只需执行 `cd ~/.config/hypr;mv hyprland.conf{,.old};mv hyprland.conf{.new,}`。
- 确保已重启Hyprland。

### 意外示例 2
```
[===诊断===] declare -p ILLOGICAL_IMPULSE_VIRTUAL_ENV
declare -x ILLOGICAL_IMPULSE_VIRTUAL_ENV="\$XDG_STATE_HOME/quickshell/.venv"
[---成功---]
```
对于上述情况，`$XDG_STATE_HOME` 未被展开，这似乎非常奇怪（可能是 Hyprland 的 bug？）。
- 确保在运行 `install.sh` 时，您未跳过并正确执行了 `install-python-packages()`，这应为您生成非空的 `~/.local/state/quickshell/.venv`。
- 您可直接在 `~/.config/hypr/custom/env.conf` 中指定其值：
```conf
env = ILLOGICAL_IMPULSE_VIRTUAL_ENV, /home/myself/.local/state/quickshell/.venv
```
请务必将`myself`替换为实际用户名。

## 必须至少尝试一次的操作
- 重启Hyprland或系统，这是应用环境变量变更的必要步骤。
- 重新运行`install.sh`以确保所有组件正确安装。该脚本具有幂等性，可多次运行以检查状态或更新点文件。

## 日志获取方式
- 若遇到问题，请打开终端（`Super`+`Enter`）运行命令，查找可能导致问题的错误/警告信息。
- 工具栏及其他Shell组件由Quickshell驱动（它不是Waybar 😭）。若出现异常，请在终端执行：`pkill qs; qs -c ii`。

## 帮助指南

1. 优先搜索本页面，其次查阅[问题记录](https://github.com/end-4/dots-hyprland/issues)和[讨论区](https://github.com/end-4/dots-hyprland/discussions)。
2. 若仍未解决，请开启新讨论。

虽然@end-4在Discord（@end_4）最活跃，但建议优先通过GitHub联系，因@clsty更熟悉安装脚本及Arch Linux相关问题

# 常见问题
## 主题显示异常

按 `Super+Ctrl+T` 切换壁纸，在弹出窗口选择图片。若无效，请在终端运行 `~/.config/quickshell/scripts/switchwall.sh`，按相同步骤操作，查看日志自行排查问题或提交至问题/讨论区

## 某些应用图标在Dock/概览中缺失

技术上无法保证图标完美匹配。系统通过应用程序类别推测图标，该类别名称未必与实际图标名称一致。

可能解决方案：
### GTK 应用：使用 `gsettings` 设置图标主题

若应用图标未包含在默认图标包中，可更换其他主题。

例如可选用[Papirus](https://github.com/PapirusDevelopmentTeam/papirus-icon-theme)。
该主题未被默认采用是因@end-4的偏好设置，但其对应用程序的覆盖率极佳。

```sh
gsettings set org.gnome.desktop.interface icon-theme Papirus
```

当然需先安装该主题，Arch Linux用户请执行：`sudo pacman -S papirus-icon-theme`。

### Qt应用：编辑kde-material-you-colors配置

打开`~/.config/kde-material-you-colors/config.conf`
查找以下行并按需修改
```ini
# ...
iconslight = breeze-plus
# ...
iconsdark = breeze-plus-dark
```
# #音乐控制按钮未显示 

>参考：[ end - 4 / d ots - h y prl and d # 1 6 8 ] ( h tt p s : // g it h u b .com / end         -4 /dots - hy prl and d / i ssu es / 16 8 ) (注：针对旧版本AGS的旧问题

-保证播放器支持Mpris协议（参考列表：[MPRIS - Arch W ik i ]( h ttps : //w iki. arch linu x.org/title / MPRIS)）
- 若使用浏览器，请安装 Plasma 集成扩展：
  - [Firefox]（https://addons.mozilla.org/en-US/firefox/addon/plasma-integration/）
  - [Chromium](https://chrom e.go ogle.com/web st ore/detail/pl as ma-integrat io n/cimiefiiaegbel he fglklhhakcgmhkai)

确定安装 `plasma-browser-integration` 源码（Arch用户适用，非Arch用户请自行查找对应源码）

则当Firefox播放媒体时，执行以下命令：
```bash
dbus-send --print-reply --dest=org.   freedeskt op .DBus / o rg/ freedesktop /D Bus org.freedes k top.DBus.ListName s |grep mpris
```
输出应包含：
````平原
字符串“org.mpris.Me d i aPlayer2 .pl as ma-brows er - 集成”
```
仅“plasma-browser-in tegration”抽取方案有效，其他方案无效。

若因质疑显示 DBus `org.mpris.MediaPlayer2.plasma-browser-integration`，
请尝试以下步骤：
1. 使用 `firefox --Profile  M a nager` 创建新的配置文件。
2.通过新配置文件启动
3.重新启动火狐并使用新配置文件再次尝试。
- _注意：调用`playerctl -Fmetadata`命令可能有助于调试._

## 显示异常图标名称和实际图标
-确保已安装Material Symbols字体（非Material Icons）。
  - Arch系统请使用`tt f -ma t eria l-sym bols- va ri abl eg it`包
  - 若发行版无对应包，请手动安装：
    - 从[Material Symbols仓库](https://github.com/google/material-design-icons/tree/master/variablefont)下载.ttf文件
   -将文件放置于`~/.local / share /fo n ts`目录
    - 执行` fc-cache -fv`刷新字体缓存
    - 使用 `Ctrl`+`Super`+`R` 重启启动

## `loginctl lock-session` 无效
> 参考：[end-4/dots - hyprland#278]（http://git hub.com/end-4/dots-hyprland/issues/278）

根据[Arch Linux论坛此帖](https://bbs.archlinux.org/viewtopic. php?pid=1311990#p 11990年31号)：
> 需有程序监听systemd- logind的D-Bus信号才能生效。

Hypridle可需要这个“程序”，因此保证其一个运行状态，
此时执行`loginctl lock-session`将向hypridle发送信号，
最最终会通过执行配置文件`~/.config/ hypr/ hypridle.conf`命令中定义`$lock_cmd`锁定屏幕。

更多详情请参阅[Hyprland Wiki](https://wiki.hyprl和.org/Hy pr-Ecosystem/hypridle/#配置）。

## F oot 终端：为何无法使用Ctrl+C？
- 在`foot`中，Ctrl+C默认用于复制文本。需额外操作请使用Ctrl+Shift+C
- 不希望有此设置？
  - 删除绑定：在`~/.config/foot/foot.ini`中的注释或删除`clipboard-copy=Con控制+c`行
  - 若预计算使用终端应用，建议使用功能更丰富的终端软件
