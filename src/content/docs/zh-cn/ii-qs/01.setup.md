---
title: 安装 / 更新 / 卸载
layout: /src/layouts/autonum.astro
lastUpdated: 2025-10-06
---

# 安装

:::caution[开始之前]
- **只提供用户级别的更改**。你需要负责系统基本功能的其他软件/配置。
- **不需要重新安装你的系统**。
:::

:::note[发行版支持]
- 自动化：请参见下方 [自动化安装](#automated-installation) 部分。
- 手动：请参见下方 [手动安装](#manual-installation) 部分。
- 复刻：请参见下方 [复刻](#forks) 部分。
:::

:::tip[从 AGS 版本迁移]
*如果你没有使用旧的 AGS 版本，或者不使用 Arch Linux，则可以跳过此步骤*

Quickshell 版本在安装后应该可以正常工作，但在安装新版本之前，你可以卸载旧包：

```sh
sudo pacman -Rs $(pacman -Q | grep "illogical-impulse-" | awk '{print $1}')
```

然后执行安装。
:::

## 自动化安装

:::note[发行版支持]
- **官方支持：**
  - Arch Linux
    - [clsty](https://github.com/clsty)（安装脚本的开发者）使用并推荐 Arch Linux："原生 Arch Linux 很好用。EndeavourOS 也不错，因为它几乎使用与 Arch Linux 相同的软件包仓库（除了[这个](https://github.com/endeavouros-team/repo)）。"
  - EndeavourOS
    - [end-4](https://github.com/end-4)（配置文件的开发者）使用并推荐 EndeavourOS："这不是必须的，但相比普通的 Arch 会更容易。"
- **部分支持：**
  - 其他 Arch 系发行版如 CachyOS、Manjaro 等。
    - 这些发行版使用与 Arch Linux 不同的软件包仓库，因此可能无法按预期工作。
    - 我们特别不推荐 Manjaro，因为它与 AUR 的兼容性相对较差。
- **社区提供：**
  - Gentoo（详见 [dist-gentoo/README.md](https://github.com/end-4/dots-hyprland/blob/main/dist-gentoo/README.md)）。
:::

:::caution[欢迎为其他发行版支持提交 PR]
`install.sh` 新增了自动选择发行版的设计，
我们需要帮助来支持其他发行版。

详见 [此页面](../../dev/inst-script/#help-wanted)。
:::

只需运行这一行：
```bash
bash <(curl -s https://ii.clsty.link/setup)
```
就是这样！
- 按照提示操作直到完成。
- 它所做的只不过是将仓库克隆到 `~/.cache/dots-hyprland` 并进入该目录，然后运行 `./install.sh`。作为替代，你也可以手动执行：
```bash
cd ~/Downloads # 任意你想要的位置
git clone https://github.com/end-4/dots-hyprland
cd dots-hyprland
./install.sh
```

:::note[域名变更]
你可能已经注意到这个 wiki（连同上面的脚本）的域名已从 `end-4.github.io` 更改为 `ii.clsty.link`。这使得你在 tty 执行此操作时能输入更短的链接，不过其本质上仍然由 GitHub Pages 提供服务。如果你在上述 `curl` 命令中添加 `-L` 参数并改用 `https://end-4.github.io/dots-hyprland-wiki/setup` 也一样可行。更多信息请见 [issue#28](https://github.com/end-4/dots-hyprland-wiki/issues/28)。
:::

:::tip[使用 install.sh]
脚本 `./install.sh` 是幂等且交互式的。

你可以随时重新运行它并选择执行某些操作。

这在想要恢复失败的尝试或更新时很有用。
:::

:::tip[克隆到不同路径]
要克隆到其他位置，只需附加路径即可，例如：
```bash
bash <(curl -s https://ii.clsty.link/setup) ~/Downloads/dots-hyprland
```
:::

## 分支

以下链接是关于其他发行版的社区分支。
:::caution
- 它们是在安装脚本不支持非 Arch 系发行版的旧时期创建的。
- 其中一些是针对旧的 AGS 版 illogical-impulse 的。
:::

- NixOS
  - 请参见 [discussion #1093](https://github.com/end-4/dots-hyprland/discussions/1093)
- OpenSUSE
  - 请参见 [discussion #485](https://github.com/end-4/dots-hyprland/discussions/485)
- Fedora
  - 请参见 [EisregenHaha/fedora-hyprland](https://github.com/EisregenHaha/fedora-hyprland)
  - 也可参见（较早的讨论）：[discussion #840](https://github.com/end-4/dots-hyprland/discussions/840)

## 手动安装

发行版支持：基本上任何发行版。

:::caution
此部分仅用于演示。

强烈不推荐使用，因为它会浪费你大量的时间。
:::

### 克隆并进入目录

```bash
t=~/.cache/dots-hyprland   # 让我们避免弄乱你的主文件夹
git clone https://github.com/end-4/dots-hyprland.git "$t" --filter=blob:none
cd "$t"
```

### 安装依赖包

对于 Arch 系发行版：
- 安装所有在那些 `./dist-arch/*/PKGBUILD` 中 `depends` 数组中列出的软件包。只需使用 AUR 助手如 `yay`。
  - 你也可以安装你所发现的合适的替代品。

对于非 Arch 发行版：
- 找出 `dist-arch/install-deps.sh` 安装的软件包的等效项。它们主要来自那些 `./dist-arch/*/PKGBUILD` 中 `depends` 数组的值，然后安装它们。
- 要获取软件包的信息（例如它提供了什么可执行文件），请在 [Arch Linux Packages](https://archlinux.org/packages) 或 [AUR](https://aur.archlinux.org/packages) 中搜索。
- `dist-fallback/install-deps.sh` 包含了一些能够安装依赖项的函数作为替代，这些不是发行版特定的，但不受系统包管理器控制。如果可能的话最好避免使用它们。
- 如果你在某些非 Arch 系 Linux 发行版上成功完成了安装，你可以创建一个 `install-<DISTRO_ID>/` 目录并提交 PR。详见[此页面](../../dev/inst-script/#help-wanted)
  - 运行 `./diagnose` 获取实际的 `<DISTRO_ID>` 值（在 `distro ID:` 后面）。

### 权限/服务设置等

阅读 `dist-arch/install-setups.sh` 的内容。
- 如果你认为它没问题，那么只需运行 `./install -f --skip-alldeps --skip-allfiles` ，这样就能运行此脚本。
  - 不要直接运行 `dist-arch/install-setups.sh`，因为它是为了被 `install.sh` 引用而设计的。
- 或者，手动运行此脚本中的行并进行调整。

### 复制配置文件
- 将 `.config`、`.local` 复制到你的主文件夹（在执行前请先查看，以免意外覆盖你自己的配置文件）
- 或者，阅读 `scriptdata/install-files.sh`。
  - 如果你认为它没问题，那么只需运行 `./install.sh --skip-alldeps --skip-allsetups` ，这样就能运行此脚本。
  - 不要直接运行 `scriptdata/install-files.sh`，因为它是为了被 `install.sh` 引用而设计的。

### 完成
- 完成后，重新登录 Hyprland。
  - `Ctrl`+`Super`+`T` 选择壁纸。
  - `Super`+`/` 查看快捷键列表。玩得开心！

# 安装后

## 不那么可选的东西

### 防止通知守护进程冲突
- 诸如 `dunst` 和 `mako` 等通知守护进程可能随你的发行版自带配置一起出现，并可能干扰 Quickshell 的实现。如果你在其他地方不使用它们，建议卸载它们。

## 可选的东西

### 额外配置

查看你是否对 `Extras` 文件夹中的任何内容感兴趣。

### 与浏览器的媒体集成

如果希望从浏览器显示媒体缩略图，请获取 "Plasma browser integration" 扩展。
- 对于 [Chromium](https://chrome.google.com/webstore/detail/plasma-integration/cimiefiiaegbelhefglklhhakcgmhkai)
- 对于 [Firefox](https://addons.mozilla.org/en-US/firefox/addon/plasma-integration/)

### ZSH 的配色方案
将此行放入你的 `~/.zshrc` 以支持 ZSH 的配色方案：
```bash
source ~/.config/zshrc.d/dots-hyprland.zsh
```

## 启动 Hyprland

- 要启动 Hyprland，你可以使用 DM（显示管理器）或直接使用 `tty`。
- Hyprland wiki 建议使用 uswm 管理的会话启动 Hyprland，但我们不这样做。使用这个不会破坏 dotfiles，但你可能会从其他桌面环境获得自动启动的垃圾文件（例如重复的身份验证对话框）

详见 [Hyprland wiki](https://wiki.hypr.land/Getting-Started/Master-Tutorial/#launching-hyprland)。以下是一些额外提示。

### 如何在 `tty1` 登录后自动启动 Hyprland？
对于 ZSH 或 BASH，在你的 `~/.zshrc` 或 `~/.bashrc` **底部**添加此行：
```bash
source ~/.config/zshrc.d/auto-Hypr.sh
```

对于 FISH，在你的 `~/.config/fish/config.fish` **底部**添加此行：
```fish
source ~/.config/fish/auto-Hypr.fish
```

附注：如果你希望通过 tty 启动 Hyprland，建议禁用 DM。

### 我是新手。什么是 tty 和 DM？

以下是简要介绍，仅供快速理解，但**不完全准确**。

你可以将 `tty` 视为 Linux 系统的某种“底层”
通常有 7 个 `tty`：`tty1` 到 `tty7`。你可以按 `Ctrl+Alt+F<n>` 切换到 `tty<n>`，然后输入用户名和密码登录。

登录后，你能够通过命令启动图形环境，例如 `Hyprland`。
一般而言，图形界面只能在登录**之后**启动。

但是如果我们想要登录界面本身就有图形界面呢？

于是 DM（Display Manager 即显示管理器，也称为 "LM"，即 Login Manager，登录管理器）出场了。
- 一些常见的 DM：
  - `sddm`：常用于 KDE Plasma。
  - `gdm`：常用于 Gnome。
- 它在系统级别启用，并在系统启动后自动启动（在还未登录时）。
  - 在基于 systemd 的发行版上，DM 通常作为 systemd 服务启用。运行以下命令查看启用了哪个 DM。
    ```bash
    grep 'ExecStart=' /etc/systemd/system/display-manager.service
    ```
    如果返回 `No such file or directory`，则没有启用 DM，或者这不是基于 systemd 的发行版。
- 它为你提供图形界面登录并选择图形环境（例如 Hyprland）。
  - DM 如何知道哪些图形环境可用？
    - 通常它会在路径 `/usr/share/xsessions` 中搜索 X11 的图形环境，以及在 `/usr/share/wayland-sessions` 中搜索 Wayland 的图形环境。
    - 这些目录下的 desktop 文件包含图形环境的信息。

# 更新

- `cd` 到仓库目录
- 运行 `git pull` 获取最新更改。
- 再次运行 `./install.sh`
  - 跳过你不想执行的步骤（特别是 `rsync ...` 步骤，因为它会**覆盖目标路径下的文件**）。
    通常你可能想运行涉及 `.config/quickshell` 的 `rsync` 步骤。

:::tip
运行 `./install.sh -h` 查看更多用法。
:::

:::caution[如果你之前手动安装]
虽然强烈不推荐，但如果你还是选择了手动安装：
- `cd` 到仓库目录
- 运行 `git pull` 获取最新更改。
- 拿走你想要的文件。通常你可能想要获取 `.config/quickshell` 文件夹。
:::

# 卸载

:::note[当前状态]
由于我们现在对 Arch 系发行版使用本地 PKGBUILD，所以
`uninstall.sh` 能够对 Arch/AUR 包进行合适的卸载，
但对配置文件的删除仍然不完美。

另见 https://github.com/end-4/dots-hyprland/issues/838#issuecomment-2406220007
:::

- 你可以尝试使用 `uninstall.sh`，但它不完美且未积极维护。
- Arch Linux 手动卸载提示：
  - 运行 `pacman -Q | grep illogical-impulse` 获取 dotfiles 所需的软件包列表
  - 对于上述命令中的每个软件包运行 `yay -Rs PACKAGE_NAME`
- 如果你在意，这里有详细的解释：

> 问题是这个仓库不是一个典型的"软件"，而是一组配置，
> 所以很难制作一个适当的卸载脚本，
> 该脚本应该还原安装脚本所做的所有更改。
>
> 例如，安装脚本会为你安装 `yay`（AUR 助手），但卸载脚本应该如何还原这些更改？
> - 删除 `yay` 或 `yay-bin`？不正确，因为你可能已经自己安装了其中一个（不是由安装脚本安装的）。
> - 即使安装脚本记录了脚本安装的软件包列表，也不应该在日志显示 `yay` 或 `yay-bin` 是由脚本安装时删除它们，因为脚本无法记录未来，你可能在安装脚本完成后几天重新安装了 `yay` 或 `yay-bin`，因此它们实际上不是由安装脚本安装的。
>
> 总之，编写适当的卸载脚本几乎是不可能的。
> 你最好根据需要手动进行还原更改。
