---
title: 安装/更新/卸载
layout: /src/layouts/autonum.astro
lastUpdated: 2025-03-31
---

# 安装指南
## 开始前须知

- 本指南仅提供**用户层面的定制方案**。系统基础功能所需的其他软件/配置需由您自行负责。
- **发行版支持**
  - 提供的安装脚本适用于 Arch Linux 发行版
  - 其他发行版请参阅下方说明（注：本文档撰写时为 AGS 版本指南，非 Quickshell 版本，但仍具参考价值）
  - end-4 使用并推荐 EndeavourOS。非强制要求，但相较常规 Arch 系统能显著简化操作
- **无需重新安装系统**

## 从AGS版本迁移

*若未使用旧版AGS或非Arch用户可跳过此步骤*

安装Quickshell版本时应能正常运行，但您可在安装新包前卸载旧包：

```sh
sudo pacman -Rs $(pacman -Q | grep “illogical-impulse-” | awk ‘{print $1}’)
```

随后执行安装

## 自动化安装（仅限Arch发行版）

**推荐方法**

运行以下单行命令并按提示操作：
```bash
bash <(curl -s “https://end-4.github.io/dots-hyprland-wiki/setup.sh”)
```
上述命令将仓库克隆至`~/.cache/dots-hyprland`。若需指定其他路径，请添加路径参数

:::note[替代方案]
若需输入更短链接
```bash
cd ~/Downloads # 任意目标目录
git clone https://github.com/end-4/dots-hyprland
cd dots-hyprland
./install.sh
```
:::

:::tip[提示]
`install.sh`脚本具有幂等性且支持交互操作：
可随时重新运行并选择执行特定步骤。
这在恢复失败操作或更新时非常实用。
:::

## NixOS (社区版)
- 目前这些点文件尚未作为flake提供。
- 参见相关讨论 #1093](https://github.com/end-4/dots-hyprland/discussions/1093)


## OpenSUSE（社区版）
- 参见讨论 #485](https://github.com/end-4/dots-hyprland/discussions/485)

## Fedora（社区版）
- 参见[EisregenHaha/fedora-hyprland](https://github.com/EisregenHaha/fedora-hyprland)
- 另见（旧讨论）：[讨论 #840](https://github.com/end-4/dots-hyprland/discussions/840)
  
## 手动安装（适用于任何发行版）
:::note[非Arch发行版注意事项]
安装依赖项时，需根据`scriptdata/arch-packages/*/PKGBUILD`文件中的`depends`数组值，自行确定对应的包名称。
- 查询软件包信息（如其提供的可执行文件），请在[Arch Linux软件包库](https://archlinux.org/packages)或[AUR](https://aur.archlinux.org/packages)中搜索。
- 若您在非Arch（或非Arch衍生）Linux发行版上成功完成安装，欢迎在[讨论区](https://github.com/end-4/dots-hyprland/discussions)分享包列表（及其他必要步骤），我们未来可据此实现自动化安装。感谢！
:::

- 克隆并进入目录
```bash
  t=~/.cache/dots-hyprland   # 避免污染用户主目录
  git clone https://github.com/end-4/dots-hyprland.git “$t” --filter=blob:none
  cd “$t”
  ```
- 获取软件包：安装所有 `scriptdata/arch-packages/*/PKGBUILD` 文件中 `depends` 数组列出的软件包。Arch Linux 用户可使用 `yay` 等 AUR 助手工具。

- 运行 `manual-install-helper.sh` 安装剩余依赖项。
  - 您也可根据实际情况安装合适的替代方案。
- 将用户加入 `video` 和 `input` 组
  ```bash
  sudo usermod -aG video,input “$(whoami)” # 若此命令失效，请将 “$(whoami)” 替换为您的用户名
  ```
- 将 `.config` 和 `.local` 目录复制到用户主目录（操作前请确认目录内容，避免覆盖个人配置文件）

- 完成后重新登录 Hyprland
  - 按 `Ctrl`+`Super`+`T` 选择壁纸
  - 按 `Super`+`/` 查看键位绑定列表。尽情享受吧！

# 安装后操作
## 不可或缺的步骤

### 避免通知守护进程冲突
- 系统自带的 `dunst` 或 `mako` 等通知守护进程可能与 Quickshell 功能冲突。若未在其他场景使用，建议卸载。

## 可选配置

### 扩展配置

可查看`Extras`文件夹中的内容。

### 浏览器媒体集成

若需在浏览器中显示媒体缩略图，请安装“Plasma浏览器集成”扩展。
- 适用于[Chromium](https://chrome.google.com/webstore/detail/plasma-integration/cimiefiiaegbelhefglklhhakcgmhkai)
- 适用于[Firefox](https://addons.mozilla.org/en-US/firefox/addon/plasma-integration/)

### ZSH配色方案
在`~/.zshrc`中添加以下内容以启用ZSH配色方案：
```bash
source ~/.config/zshrc.d/dots-hyprland.zsh
```

## 启动Hyprland
- 可通过显示管理器(DM)或直接使用`tty`启动Hyprland。
- Hyprland wiki 建议通过 uswm 管理会话启动，但我们不推荐此方式。虽然不会破坏点文件，但可能导致其他桌面环境的垃圾程序自动启动（例如重复的身份验证对话框）

详情请参阅 [Hyprland wiki](https://wiki.hyprland.org/Getting-Started/Master-Tutorial/#launching-hyprland)。以下提供额外提示：

### 如何在`tty1`登录后自动启动Hyprland？
对于ZSH或BASH用户，请在`~/.zshrc`或`~/.bashrc`文件的**末尾**添加以下内容：
```bash
source ~/.config/zshrc.d/auto-Hypr.sh
```

对于 FISH 终端，请将以下内容添加到 `~/.config/fish/config.fish` 文件的**末尾**：
```fish
source ~/.config/fish/auto-Hypr.fish
```

注：若需通过 tty 启动 Hyprland，建议禁用显示管理器（DM）。

### 我是新手。什么是 tty 和 DM？

以下简要说明可快速入门，但并非完全准确。

可将`tty`视为Linux系统的“基础单元”。
通常存在7个`tty`：`tty1`至`tty7`。按`Ctrl+Alt+F<n>`可切换至`tty<n>`，输入用户名密码即可登录。

登录后可通过命令启动图形环境，例如`Hyprland`。
实际上，多数图形界面只能在登录**之后**启动。

那么，若想为登录界面本身提供图形界面呢？

此时就需要DM（显示管理器，亦称“LM”即登录管理器）。
- 常用显示管理器：
  - `sddm`：常与KDE Plasma搭配使用
  - `gdm`：常与Gnome搭配使用
- 该组件在系统层面启用，会在系统启动后（尚未登录时）自动运行。
  - 在基于 systemd 的发行版中，DM 通常作为 systemd 服务启用。运行以下命令可查看启用的 DM：
    ```bash
    grep ‘ExecStart=’ /etc/systemd/system/display-manager.service
    ```
    若返回“No such file or directory”，则表示未启用 DM 或当前非基于 systemd 的发行版。
- 它提供图形界面供用户登录并选择图形环境（如Hyprland）。
  - 桌面管理器如何识别可用图形环境？
    - 通常会搜索路径`/usr/share/xsessions`（X11环境）和`/usr/share/wayland-sessions`（Wayland环境）。
    - 这些目录下的桌面配置文件包含图形环境的相关信息。

# 更新说明
## 若使用脚本安装
- `cd` 进入仓库目录
- 执行 `git pull` 获取最新变更
- 重新运行 `./install.sh`
  - 可跳过不需要的步骤（尤其避免执行 `rsync ...` 相关操作，因其会**覆盖目标路径下的文件**）。
    通常建议保留涉及 `.config/quickshell` 的 `rsync` 步骤。

运行 `./install.sh -h` 查看更多用法。
## 手动安装情况
- `cd` 进入仓库目录
- 运行 `git pull` 获取最新变更
- 提取所需文件。通常建议提取 `.config/quickshell` 文件夹
- 运行 `manual-install-helper.sh` 更新部分依赖项

# 卸载说明

:::note[当前状态]
由于我们现已为 Arch（及其衍生）发行版采用本地 PKGBUILD，
`uninstall.sh` 可实现对 Arch/AUR 包的规范卸载，
但配置文件清理功能尚不完善。

另请参阅 https://github.com/end-4/dots-hyprland/issues/838#issuecomment-2406220007
:::

- 可尝试使用`uninstall.sh`，但该脚本存在缺陷且未积极维护
- Arch Linux手动卸载指南：
  - 执行`pacman -Q | grep illogical-impulse`获取dotfiles所需包列表
  - 对上述命令生成的每个包执行`yay -Rs PACKAGE_NAME`
- 若需详细说明：

> 关键在于此仓库并非典型“软件”，而是配置集合，
> 因此难以编写完善的卸载脚本，
> 该脚本需撤销安装脚本的所有变更。
> 
> 例如安装脚本会自动安装 `yay`（AUR辅助工具）若系统未安装。
> 但卸载脚本该如何撤销此变更？
> - 移除`yay`或`yay-bin`？不妥当，因为您可能已自行安装过其中一个（而非通过安装脚本）。
> - 即使安装脚本记录了其安装的软件包列表， 当日志显示`yay`或`yay-bin`由脚本安装时，移除它们仍不妥当——脚本无法预知未来，你可能在安装脚本完成后重新安装了`yay`或`yay-bin`，此时它们实际已非安装脚本所为。
> 
> 综上所述，编写完善的卸载脚本几乎不可能实现。
> 建议根据实际需求手动撤销变更。
